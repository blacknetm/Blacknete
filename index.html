<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Black Net</title>
<style>
body{margin:0;background:radial-gradient(circle at top,#020617,#000);color:#00ffcc;font-family:monospace}
h1{text-align:center;margin-top:28px;letter-spacing:3px}
.subtitle{text-align:center;color:#4ade80;font-size:14px}
.container{max-width:900px;margin:0 auto;padding:20px}
.challenge{margin-top:24px;padding:14px;border:1px dashed #00ffcc;color:#e5e7eb;font-size:14px}
form{margin-top:18px}
input{width:100%;padding:12px;font-size:16px;background:#020617;color:#00ffcc;border:1px solid #00ffcc}
button{width:100%;margin-top:12px;padding:12px;font-size:16px;background:transparent;color:#00ffcc;border:2px solid #00ffcc}
button:hover{background:#00ffcc;color:#020617;cursor:pointer}
table{width:100%;margin-top:28px;border-collapse:collapse;font-size:15px}
th,td{padding:12px;border:1px solid #00ffcc}
.locked{color:#64748b}
.unlocked{color:#00ff00;font-weight:bold;text-shadow:0 0 6px #00ff00}
.error{margin-top:10px;color:red;font-size:14px}
.lock{color:#ff0000;text-align:center;margin-top:14px;font-size:14px}
</style>
</head>

<body>
<h1>Black Net</h1>
<p class="subtitle">by Miss Network (Maya)</p>

<div class="container">
  <div class="challenge" id="challengeText"></div>

  <form onsubmit="return submitAnswer()">
    <input id="answer" placeholder="Submit result / flag" />
    <button>EXECUTE</button>
    <div class="error" id="error"></div>
  </form>

  <div class="lock" id="lock"></div>

  <table>
    <tr><th>Level</th><th>Status</th></tr>
    <tbody id="levels"></tbody>
  </table>
</div>

<script>
// ===== Config =====
const TOTAL_LEVELS = 40;
const LOCK_HOURS = 15;
let state = JSON.parse(localStorage.getItem("bn_state")||"{}");
state.level = state.level || 1;
state.attempts = state.attempts || 0;
state.lockUntil = state.lockUntil || 0;

// ===== Missions (no hints) =====
const missions = {
  1:"Find the default credential used by the system.",
  2:"Identify the exposed service and submit its banner fingerprint.",
  3:"Extract a hidden value from an untrusted input reflection.",
  4:"Retrieve a restricted file reference without direct access."
};

// ===== Build table =====
const levelsEl=document.getElementById("levels");
for(let i=1;i<=TOTAL_LEVELS;i++){
  const tr=document.createElement("tr");
  tr.innerHTML=<td>${i}</td><td id="l${i}" class="${i<state.level?'unlocked':'locked'}">${i<state.level?'Unlocked':'Locked'}</td>;
  levelsEl.appendChild(tr);
}

// ===== Show mission =====
function showMission(){
  document.getElementById("challengeText").textContent =
    missions[state.level] || "No hints. Only results.";
}
showMission();

// ===== Dynamic Flag (no static answers) =====
function dynamicFlag(level){
  // epoch slice: 10 minutes
  const slice = Math.floor(Date.now()/600000);
  const salt = "bn::"+level+"::x9";
  // lightweight hash (frontend CTF-style)
  let h=0, s = salt+slice;
  for(let i=0;i<s.length;i++){h=((h<<5)-h)+s.charCodeAt(i);h|=0;}
  return ("bn"+Math.abs(h)).slice(0,8);
}

// ===== Anti-inspect (soft) =====
let slowed=false;
setInterval(()=>{
  const w = window.outerWidth - window.innerWidth > 160;
  const h = window.outerHeight - window.innerHeight > 160;
  if((w||h) && !slowed){
    slowed=true;
    // penalize gently
    state.attempts = Math.max(state.attempts,1);
    localStorage.setItem("bn_state",JSON.stringify(state));
  }
},1000);

// ===== Submit =====
function submitAnswer(){
  const now=Date.now();
  const error=document.getElementById("error");
  const lockEl=document.getElementById("lock");
  if(state.lockUntil && now<state.lockUntil){
    const mins=Math.ceil((state.lockUntil-now)/60000);
    lockEl.textContent=LOCKED â€” try again in ${mins} minutes;
    return false;
  }
  const ans=document.getElementById("answer").value.trim();
  const expected = dynamicFlag(state.level);

  if(ans===expected){
    document.getElementById(l${state.level}).textContent="Unlocked";
    document.getElementById(l${state.level}).className="u

nlocked";
    state.level++;
    state.attempts=0;
    error.textContent="";
    lockEl.textContent="";
    document.getElementById("answer").value="";
    showMission();
  }else{
    state.attempts++;
    error.textContent="ERROR: access denied";
    if(state.attempts>=3){
      state.lockUntil=Date.now()+LOCK_HOURS*60*60*1000;
      lockEl.textContent="LOCKED for 15 hours";
      state.attempts=0;
    }
  }
  localStorage.setItem("bn_state",JSON.stringify(state));
  return false;
}
</script>
</body>
  </html>
